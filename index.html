<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + React</title>
  </head>
  <body>
    <div id="root"></div>
    <canvas id="webglCanvas" style="display: none;"></canvas>
    <script type="module" src="/src/main.jsx"></script>

    <h2>BigIntPrimitive WebGL Examples</h2>
    <div>
      <label for="num1">Number 1:</label>
      <input type="text" id="num1" value="12345678901234567890">
    </div>
    <div>
      <label for="num2">Number 2:</label>
      <input type="text" id="num2" value="9876543210987654321">
    </div>
    <div>
      <label for="operation">Operation:</label>
      <select id="operation">
        <option value="add">Addition (+)</option>
        <option value="subtract">Subtraction (-)</option>
        <option value="multiply">Multiplication (*)</option>
        <option value="divide">Division (/)</option>
        <option value="remainder">Remainder (%)</option>
      </select>
    </div>
    <button id="calculateBtn">Calculate</button>
    <h3>Result:</h3>
    <pre id="resultArea"></pre>
    <pre id="errorArea" style="color: red;"></pre>

    <script type="module">
      import { BigIntPrimitive } from './lib/bigint.js';

      const num1Input = document.getElementById('num1');
      const num2Input = document.getElementById('num2');
      const operationSelect = document.getElementById('operation');
      const calculateBtn = document.getElementById('calculateBtn');
      const resultArea = document.getElementById('resultArea');
      const errorArea = document.getElementById('errorArea');
      const canvas = document.getElementById('webglCanvas'); // Get the canvas

      calculateBtn.addEventListener('click', () => {
        resultArea.textContent = '';
        errorArea.textContent = '';

        try {
          const val1 = num1Input.value;
          const val2 = num2Input.value;
          const operation = operationSelect.value;

          // Pass the canvas to the constructor
          const bigInt1 = new BigIntPrimitive(val1, canvas, { forceCPU: true });
          const bigInt2 = new BigIntPrimitive(val2, canvas, { forceCPU: true });

          let result;
          switch (operation) {
            case 'add':
              result = bigInt1.add(bigInt2);
              break;
            case 'subtract':
              result = bigInt1.subtract(bigInt2);
              break;
            case 'multiply':
              result = bigInt1.multiply(bigInt2);
              break;
            case 'divide':
              const divResult = bigInt1.divideAndRemainder(bigInt2);
              result = divResult.quotient; // Display quotient for division
              break;
            case 'remainder':
              const remResult = bigInt1.divideAndRemainder(bigInt2);
              result = remResult.remainder; // Display remainder
              break;
            default:
              throw new Error('Unknown operation');
          }
          resultArea.textContent = result.toString();
        } catch (error) {
          errorArea.textContent = error.message + (error.stack ? "\\n" + error.stack : "");
        }
      });
    </script>
  </body>
</html>
